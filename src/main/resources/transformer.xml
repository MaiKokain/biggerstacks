<!--
  ~ Copyright (c) PORTB 2023
  ~
  ~ Licensed under GNU LGPL v3
  ~ https://www.gnu.org/licenses/lgpl-3.0.txt
  -->

<transformers>
    <!--    region vanilla stuff-->
    <class path="net.minecraft.world.Container" transformChildren="true">
        <method name="getMaxStackSize" transformer="slotLimit"/>
        <method name="m_6893_" transformer="slotLimit"/>
        <!--        <blacklist>net/minecraft/world/CompoundContainer</blacklist>-->
    </class>

    <class path="net/minecraftforge/items/IItemHandler" transformChildren="true">
        <method name="getSlotLimit" transformer="slotLimit" desc="(I)I"/>
        <!--      I don't remember what this does exactly. I think it was to preserve the behaviour of sophisticated stuff's stack upgrade system  -->

        <blacklist>net/p3pp3rf1y/sophisticatedcore/inventory/InventoryHandler</blacklist>
    </class>

    <class path="net/minecraft/world/inventory/Slot" transformChildren="true">
        <method name="getMaxStackSize" transformer="slotLimit" desc="()I"/>
        <method name="m_6641_" transformer="slotLimit"/>
        <!--      I don't remember what this does exactly. I think it was to preserve the behaviour of sophisticated stuff's stack upgrade system  -->
        <blacklist>net/p3pp3rf1y/sophisticatedcore/common/gui/StorageInventorySlot</blacklist>
    </class>

<!--    endregion-->

<!-- region mekanism -->
    <!--    Mekanism seems to use completely custom GUI stuff. BasicInventorySlot is essentially its version of Slot. Easy fix -->
    <class path="mekanism/common/inventory/slot/BasicInventorySlot" transformChildren="true">
        <method name="getLimit" transformer="slotLimit"/>
    </class>


    <!--    I think this fixes the amount that is crafted from QIO terminal when shift+clicking a recipe-->
    <class path="mekanism/common/content/qio/QIOCraftingWindow" transformChildren="false">
        <method name="calculateMaxCraftAmount" transformer="replace64"/>
    </class>
    <!-- endregion -->

    <!--    Fix the max item count for computercraft -->
    <!--    copied straight from 1.18, idk if it will work -->
    <class path="dan200/computercraft/shared/turtle/apis/TurtleAPI" transformChildren="false">
        <method name="checkCount" transformer="replace64"/>
        <method name="getItemSpace" transformer="replace64"/>
    </class>

    <!--    region ic2 classic. this will make upgrades stack past 64 in the machines. best way to fix that is to use rules to limit their stack size. -->
    <class path="ic2.core.inventory.base.IHasInventory" transformChildren="true">
        <method name="getMaxStackSize" transformer="slotLimit"/>
    </class>
    <!--    endregion-->

    <!--    Fix the amount that is extracted from the terminal -->
    <class path="com.refinedmods.refinedstorage.apiimpl.network.grid.handler.ItemGridHandler" transformChildren="false">
        <method name="onExtract" transformer="replace64"
                desc="(Lnet/minecraft/server/level/ServerPlayer;Ljava/util/UUID;II)V"/>
    </class>

    <!--    iron furnaces compat-->
    <class path="ironfurnaces.tileentity.furnaces.BlockIronFurnaceTileBase" transformChildren="true">
        <method name="canSmelt" transformer="replace64"/>
        <method name="smelt" transformer="replace64"/>
        <method name="smeltItemMult" transformer="replace64"/>
        <method name="smeltFactoryItemMult" transformer="replace64"/>
    </class>

    <!--    also raise the maximum value for the configs-->
    <class path="ironfurnaces.Config" transformChildren="false">
        <!-- 1073741823 = MAXINT/2-->
        <method name="setupModdedFurnacesConfig" transformer="replaceInt" target="64" replacement="1073741823"
                ordinal="0 1 3"/>
    </class>

    <!-- region sophisticated core compat -->
    <class path="net.p3pp3rf1y.sophisticatedcore.inventory.InventoryHandler" transformChildren="false">
        <method name="getBaseStackLimit" transformer="replace64"/>
    </class>

    <class path="net.p3pp3rf1y.sophisticatedcore.common.gui.StorageContainerMenuBase" transformChildren="false">
        <method name="mergeItemStack" transformer="replace64" desc="(Lnet/minecraft/world/item/ItemStack;IIZZZ)Lnet/minecraft/world/item/ItemStack;"/>
    </class>

    <class path="net.p3pp3rf1y.sophisticatedcore.upgrades.cooking.CookingLogic" transformChildren="false">
        <method name="canSmelt" transformer="replace64"/>
    </class>

    <class path="net.p3pp3rf1y.sophisticatedcore.upgrades.stack.StackUpgradeItem" transformChildren="false">
        <method name="getInventorySlotLimit" transformer="replace64"/>
        <method name="canRemoveUpgradeFrom" transformer="replace64"/>
        <method name="canSwapUpgradeFor" transformer="replace64"/>
    </class>

    <class path="net.p3pp3rf1y.sophisticatedcore.util.InventoryHelper" transformChildren="false">
        <method name="getAnalogOutputSignal" transformer="replace64"/>
    </class>

    <class path="net.p3pp3rf1y.sophisticatedcore.util.NoopStorageWrapper" transformChildren="false">
        <method name="getInventoryHandler" transformer="replace64"/>
    </class>
    <!-- endregion -->
</transformers>